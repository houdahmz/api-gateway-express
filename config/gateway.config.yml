http:
  port: ${HTTP_PORT:-8080}

admin: 
  port: ${HTTP_PORT_ADMIN:-9876}
  host: localhost 

apiEndpoints:
  topup:
    - host: 192.168.12.115
      paths: /topup/operator*
      methods: ["POST","PATCH","GET","PUT","DELETE"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /topup/simcard*
      methods: ["POST","PATCH","GET","PUT","DELETE"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /topup/serialeport*
      methods: ["POST","PATCH","GET","PUT"]
      scopes: ['admin']   
  profile:
    - host: 192.168.12.115
      paths: /admin/company*
      methods: ["POST","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/user/:id
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/profile*
      methods: ["DELETE","GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/profile/by_userId/:id
      methods: ["GET"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /user-management/profile*
      methods: ["PUT","PATCH"]
      scopes: ['user','admin']

    - host: 192.168.12.115
      paths: /user-management/company/:id
      methods: ["PUT","PATCH"]
      scopes: ['user','admin']

    - host: 192.168.12.115
      paths: /user-management/company/profile-by-company
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /user-management/history/*
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/image*
      methods: ["GET","POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/activity
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /user-management/activity/:id
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /user-management/activity
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/type-user/by_code/:id
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/type-user
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /user-management/type-user/:id
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /user-management/type-user
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/category*
      methods: ["GET","POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/document*
      methods: ["GET","POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/company*
      methods: ["GET","POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /user-management/activity-company*
      methods: ["GET","POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

  voucher:


# valider les vouchers importer et modifier leurs status
    - host: 192.168.12.115
      paths: /voucher/document
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /voucher/document/:id
      methods: ["DELETE","GET","PUT"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: '/voucher/transaction'
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: '/voucher/transaction'
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: '/voucher/transaction/by_user/:id'
      methods: ["GET"]
      scopes: ['user']
# valider et refuser les commandes
    - host: 192.168.12.115
      paths: '/voucher/transaction/status/:id'
      methods: ["PUT"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /voucher/facial
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /voucher/facial/:id
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /voucher/facial*
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    # - host: localhost
    #   paths: /voucher/voucher*
    #   methods: ["POST"]
    #   scopes: ['admin']

    - host: 192.168.12.115
      paths: /voucher/operator
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /voucher/operator/:id
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /voucher/operator*
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /voucher/settings
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /voucher/settings/:id
      methods: ["GET"]
      scopes: ['user',"admin"]

    - host: 192.168.12.115
      paths: /voucher/settings*
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    # - host: localhost
    #   paths: /voucher/document*
    #   methods: ["POST","DELETE","PUT","PATCH","GET"]
    #   scopes: ['admin']

    # - host: localhost
    #   paths: /voucher/transaction/
    #   methods: ["GET"]
    #   scopes: ['admin']

# add voucher 
    - host: 192.168.12.115
      paths: /voucher
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /voucher/:id
      methods: ["GET","DELETE"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /voucher
      methods: ["POST"]
      scopes: ['admin']

  paymee:
    - host: 192.168.12.115
      paths: /paymee/cashin
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths:  ['/paymee/accountname/:id']
      methods: ["GET"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /paymee/transactions
      scopes: ['user']
  
  poste:
    # - host: 192.168.12.115
    #   paths: /poste/affiliation
    #   methods: ["GET"]
    #   scopes: ['user',"admin"]

    # - host: 192.168.12.115
    #   paths: /poste/affiliation/:id
    #   methods: ["GET"]
    #   scopes: ['user',"admin"]

    # - host: 192.168.12.115
    #   paths: /poste/affiliation*
    #   methods: ["POST","DELETE","PUT","PATCH"]
    #   scopes: ['admin']

    - host: 192.168.12.115
      paths: /poste/affiliation
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /poste/bill-payment
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /poste/recharge-card
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /poste/balance
      methods: ["POST"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /poste/unsubscribe*
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths: /poste/affiliation*
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /poste/affiliation/user*
      methods: ["GET"]
      scopes: ['user']
    - host: 192.168.12.115
      paths: /poste/recharge*
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /poste/recharge/user*
      methods: ["GET"]
      scopes: ['user']
    - host: 192.168.12.115
      paths: /poste/bill-payment*
      methods: ["GET"]
      scopes: ['admin']  
    - host: 192.168.12.115
      paths: /poste/bill-payment/user*
      methods: ["GET"]
      scopes: ['user']  
    - host: 192.168.12.115
      paths: /poste/transaction*
      methods: ["GET"]
      scopes: ['admin'] 
  topnet:
    - host: 192.168.12.115
      paths: /topnet/payment*
      methods: ["POST"]
      scopes: ['user']

    - host: 192.168.12.115
      paths:  /topnet/transaction/user*
      methods: ["GET"]
      scopes: ['user']
    - host: 192.168.12.115
      paths:  /topnet/transaction*
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /topnet/bill*
      methods: ["GET"]
      scopes: ['user']
  
  agent-register:
    - host: 192.168.12.115
      paths: /api/agent-register/profile/agent
      methods: ["POST"]
      scopes: ['agent']
  wallet:
      
    - host: 192.168.12.115
      paths: /wallet/supplier-service*
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /wallet/supplier-service/:id
      methods: ["GET"]
      scopes: ['user','admin']   

    - host: 192.168.12.115
      paths: /wallet/supplier-service
      methods: ["GET"]
      scopes: ['admin','user'] 

    - host: 192.168.12.115
      paths: /wallet/supplier
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/supplier
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/supplier*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/supplier*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/supplier/*
      methods: ["PATCH"]
      scopes: ['user'] 
    - host: 192.168.12.115
      paths: /wallet/supplier/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/supplier
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/reimbursed
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/reimbursed
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/reimbursed*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/reimbursed*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/reimbursed/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/reimbursed/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/reimbursed
      methods: ["POST"]
      scopes: ['admin']  
    - host: 192.168.12.115
      paths: /wallet/service
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/service
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/service*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/service*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/service/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/service/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/service
      methods: ["POST"]
      scopes: ['admin']    
    - host: 192.168.12.115
      paths: /wallet/category
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/category
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/category*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/category*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/category/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/category/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/category  
    - host: 192.168.12.115
      paths: /wallet/document
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/document
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/document*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/document*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/document/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/document/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/document     
    - host: 192.168.12.115
      paths: /wallet/currency
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/currency
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/currency*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/currency*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/currency/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/currency/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/currency   
    - host: 192.168.12.115
      paths: /wallet/feed
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/feed
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/feed*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/feed*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/feed/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/feed/*
      methods: ["DELETE"]
      scopes: ['admin']                       
    - host: 192.168.12.115
      paths: /wallet/feed   

    - host: 192.168.12.115
      paths: /wallet/intervenant/:id
      methods: ["GET"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /wallet/intervenant
      methods: ["GET"]
      scopes: ['admin']   

    - host: 192.168.12.115
      paths: /wallet/intervenant
      methods: ["POST","DELETE","PUT","PATCH"]
      scopes: ['admin']

    - host: 192.168.12.115
      paths: /wallet/commission
      methods: ["POST"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/commission
      methods: ["GET"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/commission*
      methods: ["GET"]
      scopes: ['admin']   
    - host: 192.168.12.115
      paths: /wallet/commission*
      methods: ["PUT"]
      scopes: ['admin']
    - host: 192.168.12.115
      paths: /wallet/commission/*
      methods: ["PATCH"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet/commission/*
      methods: ["DELETE"]
      scopes: ['user']                       
    - host: 192.168.12.115
      paths: /wallet/commission  
    - host: 192.168.12.115
      paths: /wallet
      methods: ["GET"]
      scopes: ['admin'] 
    - host: 192.168.12.115
      paths: /wallet
      methods: ["POST"]
      scopes: ['admin','user']   
    - host: 192.168.12.115
      paths: /wallet/:id
      methods: ["GET"]
      scopes: ['admin','user']    
    - host: 192.168.12.115
      paths: /wallet/history
      methods: ["GET"]
      scopes: ['admin']       
                                  
  api:
    host: '*'
    paths: ['/users*','/scopes*','/credentials*','/apps*']
    methods: ["GET","POST","PUT","DELETE","PATCH",PUT]
    scopes: ['super_admin']

serviceEndpoints:
  api_management:
    url: http://localhost:${HTTP_PORT_API_MANAGEMENT:-4000}/api-management
  backend:
    url: http://localhost:${HTTP_PORT_ADMIN:-9876}

policies:
  - basic-auth
  - key-auth
  - log
  - proxy
  - oauth2
  - jwt
  - request-transformer
  - validate-user
  - jwt-permissions
  - jwtScopes
  - agent-register
  - rewrite
  - middleware
  - tokenReg
  - login
  - response-transformer
  - cors

pipelines:
  # default:
  #   apiEndpoints:
  #     - profile
  #   policies:
  #     - log:
  #         - action:
  #             message: "profile eee header===> ${req.headers.authorization} ---${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
  #   # rewrite:
  #   #   -
  #   #     condition:
  #   #       name: pathmatch
  #   #       match: /:route*
  #   #     action:
  #   #       rewrite: /api_management/:route
  #     - log:
  #         - action:
  #             message: "eeerrr header===> ${req.headers.authorization} ---${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
  #     - oauth2:
  #         - action:
  #             jwt:
  #               issuer: express-gateway
  #               audience: something
  #               subject: 3pXQjeklS3cFf8OCJw9B22
  #               secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
  #               checkCredentialExistence: false
  #     - validate-user:
  #     - request-transformer:
  #         action:
  #           body:
  #             add:
  #               user: req.user
  #     - log:
  #         - action:
  #             message: "aaaa ${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"

  #     - proxy:
  #         - action:
  #             serviceEndpoint: api_management
  #             changeOrigin: true

  voucher:
    apiEndpoints:
      - voucher
    policies:
      - log:
          - action:
              message: "voucher header===> ${req.headers.authorization} ---${req.originalUrl}  ${req.url}"
      - cors:    
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      # - request-transformer:
      #     action:
      #       body:
      #         add:
      #           user: req.user
      - middleware:
      - request-transformer:
        # - condition:
        #     name: method
        #     methods:
        #     - POST
      #   -   # array of Actions optionally gated by a condition
      #      condition: # this action is executed only if path is exactly /v1
      #        name: pathExact
      #        path: /v1
        # - condition:
        #   name: method
        #   methods:
        #     - GET
        # - condition:
        #     name: oneOf
        #     conditions:
        #         -
        #             name: pathExact
        #             path: /api/facial
        #         -
        #             name: not
        #             condition:
        #                 name: method
        #                 methods:
        #                     - GET
        #                     - HEAD 
        - action:
            body:
              add:
                user: req.user

      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true

  # voucher:
  #   apiEndpoints:
  #   - voucher
  #   policies:
  #   - log:
  #     - action:
  #         message: voucher header===> ${req.headers.authorization} ---${req.originalUrl}  ${req.url}
  #   - cors:
  #   - oauth2:
  #     - action:
  #         jwt:
  #           issuer: express-gateway
  #           audience: something
  #           subject: 3pXQjeklS3cFf8OCJw9B22
  #           secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
  #           checkCredentialExistence: false
  #   - validate-user:
  #   - request-transformer:
  #       action:
  #         body:
  #           add:
  #             user: req.user
  #   - middleware:
  #   - request-transformer:
  #     # - condition:
  #     #     name: method
  #     #     methods:
  #     #     - POST
  #     - action:
  #         body:
  #           add:
  #             user: req.user
  #   - log:
  #     - action:
  #         message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
  #   - proxy:
  #     - action:
  #         serviceEndpoint: api_management
  #         changeOrigin: true

  profile:
    apiEndpoints:
      - profile
    policies:
      - log:
          - action:
              message: "profile header===> ${req.headers.authorization} ---${req}"
      - cors:
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - middleware:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true

  topup:
    apiEndpoints:
      - topup
    policies:
      - log:
          - action:
              message: "topup header===> ${req.headers.authorization} ---${req.originalUrl}  ${req.url}"
      - cors:
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"

      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true

  paymee:
    apiEndpoints:
      - paymee
    policies:
      - log:
          - action:
              message: "paymee header===> ${req.headers.authorization} ---${req.originalUrl}  ${req.url}"
      - cors:
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"

      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true

  adminAPI:
    apiEndpoints:
      - api
    policies:
      - log:
          - action:
              message: "api admin header===> ${req.headers.authorization} ${req.originalUrl}  ${req.url}"
      - cors:              
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
      - proxy:
          - action:
              serviceEndpoint: backend
              changeOrigin: true

  poste:
    apiEndpoints:
      - poste
    policies:
      - log:
          - action:
              message: "header===> ${req.headers.authorization} ---${req}"
      - cors:
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true

  topnet:
    apiEndpoints:
      - topnet
    policies:
      - log:
          - action:
              message: "topnet header===> ${req.headers.authorization} ---${req}"
      - cors:
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true
  wallet:
    apiEndpoints:
      - wallet
    policies:
      - log:
          - action:
              message: "wallet header===> ${req.headers.authorization} ---${req}"
      - cors:
      - oauth2:
          - action:
              jwt:
                issuer: express-gateway
                audience: something
                subject: 3pXQjeklS3cFf8OCJw9B22
                secretOrPublicKey: 54v3WJGBcFPh3TFgZSzovw
                checkCredentialExistence: false
      - validate-user:
      - request-transformer:
          action:
            body:
              add:
                user: req.user
      - log:
          - action:
              message: "${res.statusCode}-${req.method} ${req.originalUrl}  ${req.url}"
      - proxy:
          - action:
              serviceEndpoint: api_management
              changeOrigin: true



